# üì® –†–µ–∞–∫—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä

> üåç Other languages:
> - [Russian](./README.ru.md)
> - [English](./README.md)

## üìò –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [üì® –†–µ–∞–∫—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä ‚Äî –æ–±–∑–æ—Ä](#-—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π-–º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä)
- [üöÄ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è](#-–∫–ª—é—á–µ–≤–∞—è-–∏–¥–µ—è)
- [üß© –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#-–æ—Å–Ω–æ–≤–Ω—ã–µ-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [üß≠ –ò–¥–µ–æ–ª–æ–≥–∏—è –ø—Ä–æ–µ–∫—Ç–∞](#-–∏–¥–µ–æ–ª–æ–≥–∏—è-–ø—Ä–æ–µ–∫—Ç–∞)
- [‚öôÔ∏è –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã ‚Äî –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (Pipeline)](#-1-—è–¥—Ä–æ-—Å–∏—Å—Ç–µ–º—ã--–º–∞—à–∏–Ω–∞-—Å–æ—Å—Ç–æ—è–Ω–∏–π-pipeline)
- [‚ö°Ô∏è –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–æ–π](#-2-—Ä–µ–∞–∫—Ç–∏–≤–Ω–∞—è-–º–æ–¥–µ–ª—å-–∏-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–Ω–∞–≥—Ä—É–∑–∫–æ–π)
- [üí≥ –ú–µ—Ö–∞–Ω–∏–∑–º –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π](#-3-–º–µ—Ö–∞–Ω–∏–∑–º-–∫—Ä–µ–¥–∏—Ç–æ–≤-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- [üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî Hexagonal Architecture](#-4-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π-–ø–æ–¥—Ö–æ–¥--hexagonal-architecture)
- [üßæ –ì–∞—Ä–∞–Ω—Ç–∏–∏ –∏ —Ü–µ–ª–∏](#-5-–≥–∞—Ä–∞–Ω—Ç–∏–∏-–∏-—Ü–µ–ª–∏)
- [üí¨ –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –º–∞—Ä—à—Ä—É—Ç—ã](#-6-—Ç–∏–ø—ã-—Å–æ–æ–±—â–µ–Ω–∏–π-–∏-–∏—Ö-–º–∞—Ä—à—Ä—É—Ç—ã)
- [üßπ –ú–µ—Ö–∞–Ω–∏–∑–º –æ—á–∏—Å—Ç–∫–∏ Outbox (Garbage Collector)](#-7-–º–µ—Ö–∞–Ω–∏–∑–º-–æ—á–∏—Å—Ç–∫–∏-outbox-garbage-collector)
- [üß≠ –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤](#-8-–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-—à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ-–∫–ª–∏–µ–Ω—Ç–æ–≤)
- [üõ°Ô∏è –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π](#-9-–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å-–∏-–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ-–ø–æ–≤—Ç–æ—Ä–Ω–æ–π-–æ—Ç–ø—Ä–∞–≤–∫–∏-—Å–æ–æ–±—â–µ–Ω–∏–π)
- [üóÑÔ∏è Outbox –Ω–∞ PostgreSQL –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã—á–∏—Ç–∫–æ–π](#-10-outbox-–Ω–∞-postgresql-–∏-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–≤—ã—á–∏—Ç–∫–æ–π)
- [üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞](#-11-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø–∞–ø–æ–∫-–ø—Ä–æ–µ–∫—Ç–∞)
- [üß≠ –ò—Ç–æ–≥–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ](#-–∏—Ç–æ–≥–∏-–∏-–¥–∞–ª—å–Ω–µ–π—à–µ–µ-—Ä–∞–∑–≤–∏—Ç–∏–µ)
- [üß© PS. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ acknowledgment –∏ –æ—á–∏—Å—Ç–∫–∏ (Tetris Model)](#-ps-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ-acknowledgment-–∏-–æ—á–∏—Å—Ç–∫–∏-tetris-model)
- [üìñ PSS. –¢–µ—Ä–º–∏–Ω—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è](#-pss-—Ç–µ—Ä–º–∏–Ω—ã-–∏-–æ–±—ä—è—Å–Ω–µ–Ω–∏—è)

---


**–ú–æ–¥—É–ª—å —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏**, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –Ω–∞ **Java + Quarkus** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Mutiny** –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ **Hexagonal Architecture**.  
–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö, –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –Ω–∞–≥—Ä—É–∑–∫–æ–π.

---

## üöÄ –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ **—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ (pipeline)**,  
–≤ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Å–µ—Ä–∏—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å—Ç–∞–¥–∏–π: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç–∞–≤–∫–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è.

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –≤–æ–∫—Ä—É–≥ **—á–∏—Å—Ç–æ–≥–æ –¥–æ–º–µ–Ω–∞** (core) –∏ **–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö –ø–æ—Ä—Ç–æ–≤** (ports/adapters),  
—á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ—ë –≥–∏–±–∫–æ–π, —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–π –∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ–π –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

---

## üß© –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|-------------------------|-------------|
| ‚òï **Java 21+** | –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å, —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |
| ‚ö° **Quarkus** | –§—Ä–µ–π–º–≤–æ—Ä–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | –í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞, –º–∞–ª–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ |
| üîÅ **Mutiny** | –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ | –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã |
| üß† **Hexagonal Architecture** | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —à–∞–±–ª–æ–Ω | –ò–∑–æ–ª—è—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã |
| üß± **PostgreSQL** | –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Outbox –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π |
| ‚öôÔ∏è **Redis** | In-memory –∫—ç—à | –ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Ö—Ä–∞–Ω–µ–Ω–∏–µ watermark |
| üîê **Keycloak** | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤, —Ä–æ–ª–µ–≤–æ–π –¥–æ—Å—Ç—É–ø |
| üåê **API Gateway** | –í–Ω–µ—à–Ω–∏–π —à–ª—é–∑ | –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è WebSocket-—Å–µ—Å—Å–∏–π |

---

## üß≠ –ò–¥–µ–æ–ª–æ–≥–∏—è –ø—Ä–æ–µ–∫—Ç–∞

**–†–µ–∞–∫—Ç–∏–≤–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä** ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —á–∞—Ç.  
–≠—Ç–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏:
- üí¨ **–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –∫ —Å–±–æ—è–º;
- ‚öôÔ∏è **–£–ø—Ä–∞–≤–ª—è–µ–º–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞** (backpressure, –±—É—Ñ–µ—Ä—ã, –∫—Ä–µ–¥–∏—Ç—ã, –º–µ—Ç—Ä–∏–∫–∏);
- üß© **–ì–∏–±–∫–æ—Å—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** —á–µ—Ä–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Å–±–æ—Ä–∫—É —Å—Ç–∞–¥–∏–π –ø–∞–π–ø–ª–∞–π–Ω–∞;
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞** (OAuth2, Keycloak, —Ä–æ–ª–∏);
- üåç **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ fault-tolerance** –∑–∞ —Å—á—ë—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏—è;
- üß† **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å, –Ω–µ —Ç—Ä–æ–≥–∞—è –¥–æ–º–µ–Ω.

---

## ‚öôÔ∏è 1. –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã ‚Äî –ú–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (Pipeline)

–í –æ—Å–Ω–æ–≤–µ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ª–µ–∂–∏—Ç **–º–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π**, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–∞–∫ **–≥–∏–±–∫–∏–π –∫–æ–Ω–≤–µ–π–µ—Ä (pipeline)**.  
–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –Ω–∞–±–æ—Ä —Å—Ç–∞–¥–∏–π, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã—Ö –µ–≥–æ —Ç–∏–ø–æ–º ‚Äî —á–∞—Ç–æ–≤—ã–º, —Å–∏–≥–Ω–∞–ª—å–Ω—ã–º, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∏ —Ç.–¥.

### üî© –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∞–¥–∏–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞.
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î** ‚Äî –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç (PostgreSQL –∏–ª–∏ –¥—Ä—É–≥–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ).
3. **–û—Ç–ø—Ä–∞–≤–∫–∞ ACK** ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é.
4. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∑–∞–ø–∏—Å—å –≤ Redis –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.
5. **–î–æ—Å—Ç–∞–≤–∫–∞** ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ WebSocket –∏–ª–∏ –¥—Ä—É–≥–æ–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç.
6. **–§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–µ–ø–æ—á–∫–∏, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–π.

–ü–∞–π–ø–ª–∞–π–Ω **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∑–æ–ª—å–≤–µ—Ä–æ–º** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–ª–∏ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π;
- –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Å—Ç–∞–¥–∏–∏;
- –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —è–¥—Ä–∞.

---

## ‚ö°Ô∏è 2. –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–æ–π

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ **—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö**, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç–∞–¥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

### üß© –ú–µ—Ö–∞–Ω–∏–∑–º –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏
- –ú–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã **—Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –±—É—Ñ–µ—Ä—ã**, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞—é—â–∏–µ —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–≥—É—Ç –¥—Ä–æ–ø–∞—Ç—å—Å—è —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏.
- –í—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ **Prometheus**.

### üîÅ –ö–æ–Ω—Ç—É—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
–ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–∞:
- –∑–∞–º–µ–¥–ª—è–µ—Ç—Å—è —á—Ç–µ–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (outbox = –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö);
- —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏–π;
- –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—É.

---

## üí≥ 3. –ú–µ—Ö–∞–Ω–∏–∑–º –∫—Ä–µ–¥–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–∏—Å—Ç–µ–º–∞ –∫—Ä–µ–¥–∏—Ç–æ–≤**:
- –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –ø—É–ª –∫—Ä–µ–¥–∏—Ç–æ–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π;
- –∫—Ä–µ–¥–∏—Ç—ã **–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è** —Å —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥);
- –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ **–æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è**, –∞ –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

–≠—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç **backpressure –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞**, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ª–∞–≤–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏.

---

## üß± 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî Hexagonal Architecture

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ **—è–¥—Ä–æ (–¥–æ–º–µ–Ω)** –∏ **–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É**:

| –°–ª–æ–π | –û–ø–∏—Å–∞–Ω–∏–µ                                                        |
|------|-----------------------------------------------------------------|
| üß† **–î–æ–º–µ–Ω** | –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤, —Å—Ç–∞–¥–∏–π –∏ —Ä–µ–∑–æ–ª—å–≤–µ—Ä–æ–≤                 |
| üîå **–ü–æ—Ä—Ç—ã –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã** | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (PostgreSQL, Redis, WebSocket...) |

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥:
- –∏–∑–æ–ª–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã;
- —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–º–µ–Ω—É —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π;
- –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—ë–≥–∫–æ–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üßæ 5. –ì–∞—Ä–∞–Ω—Ç–∏–∏ –∏ —Ü–µ–ª–∏

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø–∞—Ç—Ç–µ—Ä–Ω Outbox** –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏.
- –ï—Å—Ç—å **–∫—ç—à –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º.
- –¶–µ–ª–µ–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: **‚â• 1000 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫—É–Ω–¥—É** (—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏).

---

## üí¨ 6. –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –º–∞—Ä—à—Ä—É—Ç—ã

### üí° 1. –û–±—ã—á–Ω–æ–µ —á–∞—Ç-—Å–æ–æ–±—â–µ–Ω–∏–µ (Client ‚Üí Client)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏.

**–≠—Ç–∞–ø—ã –ø–∞–π–ø–ª–∞–π–Ω–∞:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
2. –í–∞–ª–∏–¥–∞—Ü–∏—è (–ø—Ä–∞–≤–∞, —Ñ–æ—Ä–º–∞—Ç, –∫—Ä–µ–¥–∏—Ç—ã)
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î (Outbox)
4. ACK –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é
5. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—é
6. ACK –æ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è
7. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ë–î
8. –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ–≤—Ç–æ—Ä–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏

---

### üìû 2. –°–∏–≥–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ø–µ—Ä–µ–¥–∞—á–∞ —Å–æ–±—ã—Ç–∏–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ **–±–µ–∑ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏**.

**–≠—Ç–∞–ø—ã:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ (–¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏)
4. ACK –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—é
5. –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—é
6. –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- –ö–æ—Ä–æ—Ç–∫–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π `messageId` + `senderId`

---

### üìé 3. –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–ª–æ–∂–µ–Ω–∏–µ–º (—Ñ–∞–π–ª—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏.

**–≠—Ç–∞–ø—ã:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
2. –í–∞–ª–∏–¥–∞—Ü–∏—è
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è `upload URL` –∏ —Ç–æ–∫–µ–Ω–∞
4. ACK –∫–ª–∏–µ–Ω—Ç—É
5. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (MinIO –∏ —Ç.–ø.)
6. Webhook –æ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
7. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
8. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞
9. –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –î–≤—É—Ö—Ñ–∞–∑–Ω–∞—è –ª–æ–≥–∏–∫–∞ (`–∏–Ω–∏—Ü–∏–∞—Ü–∏—è` ‚Üí `–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ`)
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π webhook-—Ü–∏–∫–ª
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å S3-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏

---

### ‚öôÔ∏è 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ø–µ—Ä–µ–¥–∞—á–∞ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ –∏–ª–∏ –ª–∏–º–∏—Ç–µ –∫—Ä–µ–¥–∏—Ç–æ–≤;
- —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–∞–∑—Ä—ã–≤–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π;
- —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–≠—Ç–∞–ø—ã:**
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç—É –Ω–∞–ø—Ä—è–º—É—é
3. –ë–µ–∑ ACK –∏ –±–µ–∑ —Ö—Ä–∞–Ω–µ–Ω–∏—è

---

### üöÄ 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–∏–ø—ã (–¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
- –°–æ–±—ã—Ç–∏—è **presence** (—Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏
- –ö–æ–º–∞–Ω–¥–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ–∞–∫—Ü–∏—è, —É–¥–∞–ª–µ–Ω–∏–µ)
- –°–æ–±—ã—Ç–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

---


## üßπ 7. –ú–µ—Ö–∞–Ω–∏–∑–º –æ—á–∏—Å—Ç–∫–∏ Outbox (Garbage Collector)

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Ä–∞–∑—Ä–∞—Å—Ç–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã **Outbox** –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º **–≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤ (Watermarks)**, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º **WebSocket-—Å–µ—Å—Å–∏–π**.

---

### üîñ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

–ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –≤ –¥–≤–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:
- **History** ‚Äî –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π;
- **Outbox** ‚Äî –≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º.

–ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç **–æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è** –æ—Ç WebSocket-—Å–µ—Å—Å–∏–∏ (logout, timeout, disconnect), —Å–µ—Ä–≤–µ—Ä —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç **–≤–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ (watermark)** ‚Äî –æ—Ç–º–µ—Ç–∫—É –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.  
–≠—Ç–∞ –æ—Ç–º–µ—Ç–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **–ª–æ–∫–∞–ª—å–Ω–æ–º –∫—ç—à–µ** (–∏–ª–∏ Redis, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ Outbox.

---

### ‚öôÔ∏è –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã

1. **–°–æ–∑–¥–∞–Ω–∏–µ Watermark**  
   –ü—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `SessionManager` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `WatermarkRegistry` –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É (`timestamp`).

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ Watermark**  
   –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏–ª–∏ Redis –∏ –∂–∏–≤—ë—Ç –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.  
   –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∫–ª–∏–µ–Ω—Ç —É–∂–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ–ª—É—á–∏–ª.

3. **–û—á–∏—Å—Ç–∫–∞ Outbox**  
   –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å (`GarbageCollector`), –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π `GarbageScheduler`, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç Watermarks –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.  
   –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ Outbox, —á—å—è –ø–æ–∑–∏—Ü–∏—è **–º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É Watermark.

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è**  
   –¢–∞–∫ –∫–∞–∫ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–∂–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ History, –æ—á–∏—Å—Ç–∫–∞ Outbox **–Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö**.  
   –ü—Ä–∏ –Ω–æ–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∑–∞–ø—Ä–∞—à–∏–≤–∞—è –∏—Å—Ç–æ—Ä–∏—é –Ω–∞—á–∏–Ω–∞—è —Å Watermark.

---

### üß© –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- Outbox –æ—Å—Ç–∞—ë—Ç—Å—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º.
- –û—á–∏—Å—Ç–∫–∞ –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.
- –õ–µ–≥–∫–æ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç—Å—è —Å –ª—é–±–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è (PostgreSQL, Redis, InMemory).
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —á–∏—Å–ª–∞ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–π –∏ –Ω–µ –º–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø–æ—Ç–æ–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

---

> üí° Outbox ‚Äî —ç—Ç–æ –±—É—Ñ–µ—Ä –∂–∏–≤–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏,  
> History ‚Äî –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ,  
> Watermark + GarbageCollector ‚Äî —Å–≤—è–∑–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –≤ —á–∏—Å—Ç–æ–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

---

## üß≠ 8. –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** —á–µ—Ä–µ–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è–º –Ω–∞ —É—Ä–æ–≤–Ω–µ **API Gateway**.  
–¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –≥–æ–Ω–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ–±—â–∏–º Outbox –∏ –¥–µ–ª–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.

---

### üî© –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

- **API Gateway** –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –±–∞–ª–∞–Ω—Å–∏—Ä—É–µ—Ç –∏—Ö **–ø–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º—É –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É (ClientID)**.
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ `ClientID` **–≤—Å–µ–≥–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—é –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞**.
- –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `CRC32(ClientID) mod N`, –≥–¥–µ `N` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–π).

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –ø–æ–ª—É—á–∞–µ—Ç:
- —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤;
- –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Å–µ—Å—Å–∏–π;
- –ª–æ–∫–∞–ª—å–Ω—ã–µ –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏ (watermarks);
- –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –¥–æ—Å—Ç–∞–≤–∫—É –∏ –æ—á–∏—Å—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

### ‚öôÔ∏è –†–∞–±–æ—Ç–∞ —Å –æ–±—â–∏–º Outbox

- –í—Å–µ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–æ–±—â—É—é —Ç–∞–±–ª–∏—Ü—É Outbox** (PostgreSQL).
- –ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∏–∑ Outbox –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è **–æ—Ç–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è**, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –µ—ë –∫–ª–∏–µ–Ω—Ç–∞–º,  
  –ø–æ —Ç–æ–º—É –∂–µ –ø—Ä–∞–≤–∏–ª—É —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API Gateway.
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è–º–∏.
- –û—á–∏—Å—Ç–∫–∞ Outbox (—á–µ—Ä–µ–∑ GarbageCollector) —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º –¥–∞–Ω–Ω–æ–π –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏**.

---

### üß± –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞

- üîí **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–æ–Ω–æ–∫:** –∫–∞–∂–¥–∞—è –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ ‚Äú—Å–≤–æ–∏–º–∏‚Äù –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.
- ‚ö° **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:** –æ–±—â–∞—è —Ç–∞–±–ª–∏—Ü–∞ Outbox –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–∏–∑–∏–Ω–≥–∞.
- üìà **–õ–∏–Ω–µ–π–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∏–Ω—Å—Ç–∞–Ω—Ü–∏–π –Ω–∞–≥—Ä—É–∑–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è.
- üß© **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ –ø–∞–π–ø–ª–∞–π–Ω–∞.

---

### üß† –ò—Ç–æ–≥

> –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ **¬´ClientID ‚Üí Instance¬ª**,  
> —á—Ç–æ –¥–µ–ª–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π, –∞ Outbox ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –∏ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–º.  
> –í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã –æ–±—Å–ª—É–∂–∏–≤–∞—é—Ç—Å—è —Å–≤–æ–µ–π –∏–Ω—Å—Ç–∞–Ω—Ü–∏–µ–π, –∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞—ë—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–∏ –ª—é–±–æ–º —á–∏—Å–ª–µ —É–∑–ª–æ–≤.

---

## üõ°Ô∏è 9. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

–î–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏**. –û–Ω –Ω–µ–æ–±—Ö–æ–¥–∏–º, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏–∑-–∑–∞:

- –ß–∞—Å—Ç–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–∫–µ–¥—É–ª–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Ç—ã–≤–∞–µ—Ç Outbox;
- –ó–∞–¥–µ—Ä–∂–∫–∏ ACK –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞;
- –°–µ—Ç–µ–≤–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∑–∞–¥–µ—Ä–∂–µ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏;
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –∏ –≥–æ–Ω–æ–∫ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–ø—Ä–∞–≤–∫–∏.

–ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è, —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∏ –Ω–∞—Ö–æ–¥—è—â–∏–µ—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ (TTL).

---

### üîπ –†–∞—Å—á—ë—Ç TTL

–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∑–∞–ø–∏—Å–∏ –≤ –±—É—Ñ–µ—Ä–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç:

1. **–õ–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ (`delta_network`)** ‚Äî –≤—Ä–µ–º—è, –∑–∞ –∫–æ—Ç–æ—Ä–æ–µ ACK –º–æ–∂–µ—Ç –ø—Ä–∏–π—Ç–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞.
2. **–ë—É—Ñ–µ—Ä ACK (`delta_ack_flush`)** ‚Äî –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Outbox.
3. **–ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–∫–µ–¥—É–ª–µ—Ä–∞ (`S`)** ‚Äî –ø–µ—Ä–∏–æ–¥ –≤—ã—á–µ—Ç–∫–∏ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Outbox.
4. **–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å (`delta_processing`)** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.

**–§–æ—Ä–º—É–ª–∞ TTL:**
```
TTL = delta_network + delta_ack_flush - S + delta_processing
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á—ë—Ç–∞ (–¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏):**

- `delta_network` = 2 —Å–µ–∫
- `delta_ack_flush` = 0.5 —Å–µ–∫
- `S` = 1 —Å–µ–∫
- `delta_processing` = 0.1 —Å–µ–∫

```
TTL = 2 + 0.5 - 1 + 0.1 = 1.6 —Å–µ–∫ ‚âà 2 —Å–µ–∫—É–Ω–¥—ã
```
–¢–æ –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –±—É—Ñ–µ—Ä–µ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –æ–∫–æ–ª–æ **2 —Å–µ–∫—É–Ω–¥**, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å —É—á—ë—Ç–æ–º —Å–µ—Ç–µ–≤–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ —Ü–∏–∫–ª–æ–≤ —Å–∫–µ–¥—É–ª–µ—Ä–∞.

---

### üîπ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –±—É—Ñ–µ—Ä –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ø–æ `messageId`.
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ `currentTime - timestamp < TTL`, —Å–æ–æ–±—â–µ–Ω–∏–µ **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è**.
- –ò–Ω–∞—á–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –∑–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –±—É—Ñ–µ—Ä —Å —Ç–µ–∫—É—â–∏–º timestamp.

2. **–£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –±—É—Ñ–µ—Ä–∞**
- –ü—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Ç–æ–ª—å–∫–æ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ TTL** –∏–ª–∏ –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É—Ñ–µ—Ä–∞.
- ACK –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ.
- –°—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É FIFO, —á—Ç–æ–±—ã –≤—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–≤–∞–ª—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞.

3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–∞**
- **–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `ConcurrentInsertionOrderMap` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç O(1) –¥–æ—Å—Ç—É–ø –ø–æ `messageId` –∏ FIFO-–æ—á–∏—Å—Ç–∫—É.
- **Redis**: –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, TTL –∑–∞–¥–∞—ë—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ Redis, –Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–µ—Ç–µ–≤—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.

---

### üîπ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏ –≥–æ–Ω–∫–∞—Ö —Å–∫–µ–¥—É–ª–µ—Ä–∞ –∏ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–¥–µ—Ä–∂–∫–∞—Ö.
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ WebSocket –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã.
- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å O(1) –¥–æ—Å—Ç—É–ø–æ–º –∏ FIFO-–æ—á–∏—Å—Ç–∫–æ–π.
- –ì–∏–±–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –ª–æ–∫–∞–ª—å–Ω–æ –≤ –ø–∞–º—è—Ç–∏ –∏–ª–∏ —á–µ—Ä–µ–∑ Redis –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º.

---

## üóÑÔ∏è 10. Outbox –Ω–∞ PostgreSQL –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã—á–∏—Ç–∫–æ–π

Outbox, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –∑–∞–ø–∏—Å—å –≤ Outbox –∏ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.

- **–í—Å—Ç–∞–≤–∫–∞**: –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å **–≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**, —á—Ç–æ–±—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å Outbox –∏ –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π.
- **–í—ã–±–æ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏**: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **`SELECT ... FOR UPDATE`** —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π **leasing**.
- Leasing ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Ä–∫–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã—á–∏—Ç—ã–≤–∞–Ω–∏–µ —Ç–æ–≥–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è–º–∏ —Å–∫–µ–¥—É–ª–µ—Ä–∞.
- –í—Ä–µ–º—è leasing –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∞—Ç–Ω–æ —Ü–∏–∫–ª–∞–º —Å–∫–µ–¥—É–ª–µ—Ä–∞, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —É—Å–ø–µ–≤–∞–µ—Ç –±—ã—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–∞–∑, –ø—Ä–µ–∂–¥–µ —á–µ–º —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏.
- **–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å —Å–∫–µ–¥—É–ª–µ—Ä–∞**: –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—ä–µ–º–∞ –±–∞—Ç—á–µ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Å–∫–µ–¥—É–ª–µ—Ä –≤—ã—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫, leasing –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 3 —Å–µ–∫—É–Ω–¥—ã (—Ç—Ä–∏ —Ü–∏–∫–ª–∞ —Å–∫–µ–¥—É–ª–µ—Ä–∞).

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–≥–æ Outbox:**

- –ü—Ä–æ—Å—Ç–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Ü–∏–π –±–µ–∑ –≥–æ–Ω–æ–∫.
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Ç–∫–∏ –∏ leasing –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

> ‚úÖ –í —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏: –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ Outbox –Ω–∞ PostgreSQL –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π, –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–π.
---

## üß© 11. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Hexagonal Architecture (Ports & Adapters), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å, —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

üß† config/

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

- **KeycloakConfig** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Keycloak –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
- **MessengerConfig** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–∞—Ç—á–µ–π, —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –ø—Ä–æ—á–∏—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ–ø—Ü–∏–π.

‚öôÔ∏è core/

–û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ó–¥–µ—Å—å —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

- **backpressure/** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —á–µ—Ä–µ–∑ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ publisher‚Äô—ã –∏ –º–µ—Ç—Ä–∏–∫–∏.
- **credits/** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–∞–Ω–∞–ª–∞–º, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ª–µ–Ω–∏–≤—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è).
- **feedback/** ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, —Å–±–æ—Ä health-—Å–æ–±—ã—Ç–∏–π –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —á–∞—Å—Ç–æ—Ç—ã –æ–ø—Ä–æ—Å–æ–≤.
- **garbage/** ‚Äî —Å–±–æ—Ä –∏ –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä—ã outbox.
- **poller/** ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å outbox –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (pollers).
- **presence/** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è).
- **router/** ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –∏ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ pipeline —Å—Ç–∞–¥–∏–π. –í–∫–ª—é—á–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É ack/outbox/cache —Å—Ç–∞–¥–∏–π.
- **session/** ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Å–µ—Å—Å–∏–π –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏—Ö –æ—á–∏—Å—Ç–∫–∏.
- **watermark/** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–æ–¥—è–Ω—ã—Ö –º–µ—Ç–æ–∫ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

üèõÔ∏è domain/

–î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã ‚Äî –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –û–ø—Ä–µ–¥–µ–ª—è—é—Ç, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞, –∞ –Ω–µ –∫–∞–∫.

- **generator/** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, ULID).
- **message/** ‚Äî –±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π: Message, MessageEnvelope, MessageType.
- **session/** ‚Äî –¥–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å–µ—Å—Å–∏–∏ (ClientSession, ClientData).
- **stage/** ‚Äî —Å—Ç–∞—Ç—É—Å—ã —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- **validator/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- **watermark/** ‚Äî –¥–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –≤–æ–¥—è–Ω—ã—Ö –º–µ—Ç–æ–∫ (–ø–æ–∑–∏—Ü–∏—è, –æ—Ç–º–µ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è).

üß∞ infrastructure/

–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä—Ç–æ–≤ (–∞–¥–∞–ø—Ç–µ—Ä—ã), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ —Å–≤—è–∑—å core-—É—Ä–æ–≤–Ω—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏: –ë–î, –∫—ç—à–µ–º, WebSocket –∏ REST.

- **cache/** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—ç—à–µ–π (in-memory, Redis): –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, presence –∏ watermark.
- **persistence/** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (in-memory –∏ Postgres) –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ outbox.
- **rest/** ‚Äî REST API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–æ–∫–µ–Ω–æ–≤.
- **websocket/** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏: –ø—Ä–∏—ë–º, –¥–æ—Å—Ç–∞–≤–∫–∞, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

üîå ports/

–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É core –∏ infrastructure.  
–ó–¥–µ—Å—å –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ —è–¥—Ä–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –≤–Ω–µ—à–Ω–∏–º –º–∏—Ä–æ–º.

- **channel/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–Ω–∞–ª–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- **history/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
- **idempotency/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.
- **notifier/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
- **outbox/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–±–æ—Ç—ã —Å outbox-—Ç–∞–±–ª–∏—Ü–µ–π.
- **presence/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤.
- **session/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏.
- **watermark/** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–µ—Å—Ç—Ä–∞ –≤–æ–¥—è–Ω—ã—Ö –º–µ—Ç–æ–∫.

‚è∞ scheduler/

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ –∑–∞–¥–∞—á, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π.

- **RoutingScheduler** ‚Äî –æ–ø—Ä–æ—Å outbox –∏ —Ä–∞—Å—Å—ã–ª–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π.
- **GarbageScheduler** ‚Äî –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∫–µ—à–µ–π.
- **TestScheduler** ‚Äî —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ —Ç–µ—Å—Ç–æ–≤.

## üß≠ –ò—Ç–æ–≥–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

–ü—Ä–æ–µ–∫—Ç **—Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞** –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–∞–∑–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –∫–∞—Ä–∫–∞—Å–∞ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

### üéØ –ë–ª–∏–∂–∞–π—à–∏–µ —Ü–µ–ª–∏
- **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–æ–º–µ–Ω–∞ (DOMAIN):** –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–π.
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π:** –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –ø–æ—Ç–æ–∫–æ–≤, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á, –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –º–µ–∂–¥—É —Å—Ç–∞–¥–∏—è–º–∏.
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:** –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Å—Å–∏–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏ —Ä–∞—Å—Å—ã–ª–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
- **–†–∞–∑–≤–∏—Ç–∏–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:** —É–ª—É—á—à–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è–º, —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ —à–∞—Ä–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ API Gateway.
- **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏:** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è latency, –æ—à–∏–±–æ–∫, –±—É—Ñ–µ—Ä–æ–≤ –∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç–∞–¥–∏–π (—ç–∫—Å–ø–æ—Ä—Ç –≤ Prometheus).
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö (–ª–æ–∫–∞–ª—å–Ω–æ, –∫–ª–∞—Å—Ç–µ—Ä, Docker Compose).
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:** –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø–æ—Ä—Ç–æ–≤ –¥–ª—è PostgreSQL (Outbox, –∏—Å—Ç–æ—Ä–∏—è) –∏ Redis (–∫—ç—à –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è, watermark, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å).

### üå± –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –∫–∞–∫ **—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ä–µ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏**,
–∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è:
- –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤;
- real-time —Å–∏—Å—Ç–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π;
- —Å–µ—Ä–≤–∏—Å–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏.

–¶–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å **–æ—Ç–∫—Ä—ã—Ç—ã–π, –Ω–∞–¥—ë–∂–Ω—ã–π –∏ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–π —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–π messaging-–º–æ–¥—É–ª—å**,
—Å–ø–æ—Å–æ–±–Ω—ã–π —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–¥ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –∏ –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

---

##  üß© PS. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ acknowledgment –∏ –æ—á–∏—Å—Ç–∫–∏ (Tetris Model)

–î–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏, idempotency –∏ Watermark-–∫–æ–Ω—Ç—Ä–æ–ª—è,  
–æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å **–∏–≥—Ä–æ–π ‚Äú–¢–µ—Ç—Ä–∏—Å‚Äù** üéÆ.  
–ö–∞–∂–¥–æ–µ ACK-—Å–æ–±—ã—Ç–∏–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç ¬´—è—á–µ–π–∫—É¬ª –≤ –ø–æ—Ç–æ–∫–µ –æ—Ñ—Ñ—Å–µ—Ç–æ–≤, –∞ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä ACK-–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç ¬´—Å–ª–æ–∏¬ª, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø–æ–ª–Ω–µ–Ω—ã.

---

### ‚öôÔ∏è –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

1. **PostgreSQL** ‚Äî –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –∏—Å—Ç–æ—Ä–∏—é (–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ outbox).
2. **Debezium ‚Üí Kafka** ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É—é—Ç—Å—è –≤ `topic messages`, –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ `clientId` –∏–ª–∏ `clientShard`.
3. **Messenger Consumer** —á–∏—Ç–∞–µ—Ç Kafka, –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ WebSocket –∫–ª–∏–µ–Ω—Ç—É.
4. **–ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ACK**, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ Redis –∏–ª–∏ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ Kafka (`topic acks`).
5. **ACK-–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä** (Kafka Streams / –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å) —Å–æ–±–∏—Ä–∞–µ—Ç ACK-—Å–æ–±—ã—Ç–∏—è –∏ *—Å–∫–ª–µ–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã* (–∞–Ω–∞–ª–æ–≥–∏—è —Å ¬´—Ç–µ—Ç—Ä–∏—Å-—Å–ª–æ—è–º–∏¬ª), —Ñ–æ—Ä–º–∏—Ä—É—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã per-client.
6. –ü–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –∏ watermarks –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è **`global_safe_offset`** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∞–≤–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
7. –≠—Ç–æ—Ç `global_safe_offset` —Å–ª—É–∂–∏—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π –≥—Ä–∞–Ω–∏—Ü–µ–π –¥–ª—è **–æ—á–∏—Å—Ç–∫–∏ outbox / Kafka / Postgres**.

---

### üîÅ –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∏ –¥–æ—Å—Ç–∞–≤–∫–∞

Messenger-consumer –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç ¬´replay¬ª:
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ `logicalBasePosition` (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞);
- –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç Kafka –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤;
- –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç **–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É** –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏ —Å–±–æ—è—Ö, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞—Ö –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö.

---

### üß± –í–∞—Ä–∏–∞–Ω—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### üÖ∞Ô∏è –í–∞—Ä–∏–∞–Ω—Ç A ‚Äî Redis (runtime) + Postgres (backup)
**–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥.**

Redis:
- –±—ã—Å—Ç—Ä—ã–π in-memory store –¥–ª—è ACK-–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, watermarks –∏ `global_safe_offset`;
- ZSET –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è `right_bound` –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞;
- Lua-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ–≥–æ merge –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤.

Postgres:
- –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ snapshot-–æ–≤ (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π persist –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ —Å–±–æ—è).

**–¢–∏–ø–æ–≤—ã–µ –∫–ª—é—á–∏ Redis:**

```
client:{id}:ranges ‚Üí JSON/CBOR —Å–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ [[s1,e1],[s2,e2],...]
clients:right_bounds ‚Üí ZSET (score = right_bound, member = clientId)
client:{id}:watermark_ts ‚Üí timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
global:safe_offset ‚Üí —Ç–µ–∫—É—â–∏–π –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º
idempotency:{msgId} ‚Üí TTL entry –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –¥—É–±–ª–µ–π
```


**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
- –ü—Ä–∏ ACK:
    1. –°—á–∏—Ç–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã `client:{id}:ranges`
    2. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å –Ω–æ–≤—ã–º –æ—Ñ—Ñ—Å–µ—Ç–æ–º (merge)
    3. –û–±–Ω–æ–≤–∏—Ç—å `right_bound` –∏ ZSET
    4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å `global:safe_offset`
    5. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å snapshot –≤ Postgres

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ (`O(1)` –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º)
- –ë—ã—Å—Ç—Ä–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ (`ZRANGE 0 0`)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∞–≤–∫–µ (¬µs‚Äìms)

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- Redis —Ç—Ä–µ–±—É–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ù—É–∂–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö snapshot-–æ–≤ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

#### üÖ±Ô∏è –í–∞—Ä–∏–∞–Ω—Ç B ‚Äî Kafka Streams / ksqlDB + Compacted Topics
**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –±–µ–∑ Redis.**

- `topic acks` ‚Üí Kafka Streams App ‚Üí –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç ACK –ø–æ `clientId`
- —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ compacted topic `ack_ranges`
- –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç `global_safe_offset` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ compacted topic `global_offset`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –≤—ã—Å–æ–∫–∞—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ;
- –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ durable-—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–µ–∑ –≤–Ω–µ—à–Ω–µ–π –ë–î;
- –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è state store.

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- —Ç—Ä–µ–±—É–µ—Ç Kafka Streams –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã;
- –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ latency (–Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è ACK-–∞–≥—Ä–µ–≥–∞—Ü–∏–∏).

---

### üßÆ –ê–ª–≥–æ—Ä–∏—Ç–º merge (Tetris-—Å–∫–ª–µ–π–∫–∞)

–ö–∞–∂–¥—ã–π ACK ‚Äî —ç—Ç–æ –æ—Ñ—Ñ—Å–µ—Ç `o`.

–•—Ä–∞–Ω–∏–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã `[ [s1,e1], [s2,e2], ... ]` (–Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ).

–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –Ω–æ–≤–æ–≥–æ `o`:
1. –ù–∞—Ö–æ–¥–∏–º –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º—ã–∫–∞—é—Ç —Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞.
2. –û–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö (–≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ).
3. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –ø—Ä–∞–≤—É—é –≥—Ä–∞–Ω–∏—Ü—É.

**–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –í Java-—Å–µ—Ä–≤–∏—Å–µ (Quarkus) ‚Äî –ø—Ä–æ—Å—Ç–æ –∏ –±—ã—Å—Ç—Ä–æ.
- –í Redis ‚Äî —á–µ—Ä–µ–∑ Lua-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ (merge + HSET –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏).

---

### üåç –í—ã—á–∏—Å–ª–µ–Ω–∏–µ `global_safe_offset`

```text
1. ZSET clients:right_bounds ‚Äî —Ö—Ä–∞–Ω–∏—Ç right_bound –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
2. global_safe_offset = ZRANGE clients:right_bounds 0 0 WITHSCORES.
3. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ right_bound —É –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å global_safe_offset.
4. –î–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å leaveStamp ‚Üí —É–¥–∞–ª–∏—Ç—å –∏–∑ ZSET.
```
---

## üìñ PSS. –¢–µ—Ä–º–∏–Ω—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è

| –¢–µ—Ä–º–∏–Ω | –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ / –û–±—ä—è—Å–Ω–µ–Ω–∏–µ                                                                               |
|--------|--------------------------------------------------------------------------------------------------------|
| **Reactor / Reactive model** | –ú–æ–¥–µ–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π, –≥–¥–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ.                |
| **Pipeline (–∫–æ–Ω–≤–µ–π–µ—Ä)** | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—Ç–∞–¥–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π: –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚Üí –∑–∞–ø–∏—Å—å ‚Üí –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Üí ACK.                    |
| **Mutiny** | –†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Quarkus, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö.                 |
| **Hexagonal Architecture (–ü–æ—Ä—Ç—ã –∏ –∞–¥–∞–ø—Ç–µ—Ä—ã)** | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É (–¥–æ–º–µ–Ω) –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏.     |
| **Outbox** | –ë—É—Ñ–µ—Ä, –∫—É–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π ‚Äî –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É.                              |
| **History** | –û—Å–Ω–æ–≤–Ω–æ–µ –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–æ–æ–±—â–µ–Ω–∏–π (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ Outbox).                          |
| **Watermark** | –ú–∞—Ä–∫–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–∑—Ä—ã–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Å–µ—Å—Å–∏–∏) –∫–ª–∏–µ–Ω—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ Outbox —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å ACK.   |
| **Garbage Collector (GC)** | –ü—Ä–æ—Ü–µ—Å—Å, —É–¥–∞–ª—è—é—â–∏–π —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ Outbox –Ω–∞ –æ—Å–Ω–æ–≤–µ Watermark.                                    |
| **ACK (Acknowledgment)** | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –æ –¥–æ—Å—Ç–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è.                                                         |
| **Backpressure** | –ú–µ—Ö–∞–Ω–∏–∑–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ö–æ–¥—è—â–µ–≥–æ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∏—Ç—å —Å–∏—Å—Ç–µ–º—É.                            |
| **Credits system (–ö—Ä–µ–¥–∏—Ç—ã)** | –°—á—ë—Ç—á–∏–∫ –ª–∏–º–∏—Ç–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ backpressure.                     |
| **Idempotency (–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)** | –ì–∞—Ä–∞–Ω—Ç–∏—è, —á—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –∏–∑–º–µ–Ω–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.                      |
| **Leasing (–ª–∏–∑–∏–Ω–≥)** | –ú–µ—Ö–∞–Ω–∏–∑–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –≤—ã—á–∏—Ç–∫–µ –∏–∑ Outbox, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–µ–π.                     |
| **Presence** | –°–æ—Å—Ç–æ—è–Ω–∏–µ "–æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω" –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫—ç—à–∏—Ä—É–µ–º–æ–µ –≤ Redis.                                           |
| **Session Manager** | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö WebSocket-—Å–µ—Å—Å–∏–π.                                   |
| **Redis** | –ë—ã—Å—Ç—Ä–∞—è in-memory –ë–î –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è, –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∏ presence.            |
| **Prometheus** | –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∫—É–¥–∞ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.                          |
| **Quarkus** | Java-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∏ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –±—ã—Å—Ç—Ä—ã–º —Å—Ç–∞—Ä—Ç–æ–º –∏ –Ω–∏–∑–∫–∏–º –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–æ–≤.  |
| **Tetris Model** | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –º–µ—Ç–∞—Ñ–æ—Ä–∞ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è ACK-–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤, –≥–¥–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ ‚Äú—Å–ª–æ–∏‚Äù –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –æ—á–∏—â–∞—Ç—å. |
| **CRC32(ClientID) mod N** | –ú–µ—Ç–æ–¥ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –∏–Ω—Å—Ç–∞–Ω—Ü–∏—è–º –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏.                     |

---

> üí° *–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –º–æ–∂–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å –ø–æ –º–µ—Ä–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ —Ç–µ—Ä–º–∏–Ω–æ–≤ –≤ —Å–∏—Å—Ç–µ–º—É.*


> ‚öôÔ∏è _–ú—ã —Å—Ç—Ä–æ–∏–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã,
> –≥–¥–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —á–∏—Å—Ç–æ—Ç–∞ ‚Äî –Ω–µ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å, –∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç._